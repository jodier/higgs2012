#include "HiggsZZ4lUtils/MzzWeightFromMCFM.h"

double GetMzzWeightFromMCFM(double mZZNt){

  double WeightGeneralMCNt=1. ;// this is the scale factor
  // mZZNt is the mass of the ZZ object in GeV
  if(mZZNt>310.)
    WeightGeneralMCNt*=0.73;
  else if(mZZNt>180.)
    WeightGeneralMCNt*=0.6107 + 0.00039*mZZNt;
  else
    { double factor[116]={2.05331,0.932598,1.00563,1.08063,1.11603,1.05525,0.985384,1.01695,0.994296,1.01691,1.07068,1.34522,2.65941,15.7457,63.5411,6.74254,1.96104,0.879339,0.671156,0.673718,0.692057,0.679217,0.682887,0.692221,0.700326,0.697028,0.692527,0.732468,0.734315,0.728141,0.70173,0.689671,0.670026,0.680901,0.673741,0.685985,0.697456,0.685317,0.714068,0.668426,0.70176,0.698039,0.712542,0.713112,0.703198,0.701228,0.741751,0.691048,0.744418,0.703947,0.71058,0.734554,0.744117,0.70228,0.737927,0.69499,0.751234,0.696646,0.69727,0.627387,0.677618,0.721724,0.728123,0.746071,0.667909,0.69703,0.753821,0.766976,0.701849,0.744167,0.818674,0.789264,0.79076,0.693181,0.759099,0.729409,0.757381,0.673895,0.716732,0.780877,0.718029,0.709378,0.719849,0.747396,0.782988,0.681631,0.729953,0.741397,0.648583,0.765932,0.815904,0.748056,0.712997,0.76987,0.725309,0.626351,0.665425,0.740773,0.746259,0.658696,0.682817,0.725641,0.828763,0.686733,0.674059,0.824125,0.709402,0.690601,0.708173,0.749627,0.659649,1.0175,0.774429,0.865461,0.613712,0.757548};
      
      double mass2[116]={22.5,27.5,32.5,37.5,42.5,47.5,52.5,57.5,62.5,67.5,72.5,77.5,82.5,87.5,92.5,97.5,102.5,107.5,112.5,117.5,122.5,127.5,132.5,137.5,142.5,147.5,152.5,157.5,162.5,167.5,172.5,177.5,182.5,187.5,192.5,197.5,202.5,207.5,212.5,217.5,222.5,227.5,232.5,237.5,242.5,247.5,252.5,257.5,262.5,267.5,272.5,277.5,282.5,287.5,292.5,297.5,302.5,307.5,312.5,317.5,322.5,327.5,332.5,337.5,342.5,347.5,352.5,357.5,362.5,367.5,372.5,377.5,382.5,387.5,392.5,397.5,402.5,407.5,412.5,417.5,422.5,427.5,432.5,437.5,442.5,447.5,452.5,457.5,462.5,467.5,472.5,477.5,482.5,487.5,492.5,497.5,502.5,507.5,512.5,517.5,522.5,527.5,532.5,537.5,542.5,547.5,552.5,557.5,562.5,567.5,572.5,577.5,582.5,587.5,592.5,597.5};
      
      int ji=0;
      for(ji=0;ji<116;ji++)
        {
          if(mZZNt<mass2[ji])
            break;
        }
      if(ji==116)
        ji=115;
      WeightGeneralMCNt*=factor[ji-1]+(factor[ji]-factor[ji-1])/(mass2[ji]-mass2[ji-1])*(mZZNt-mass2[ji-1]);

    }
  return WeightGeneralMCNt;
}
